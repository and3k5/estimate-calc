import{d as B,_ as O,c as p,o as y,w as g,a as u,v as A,b as w,e as P,F as U,r as V,t as D}from"./index-CuhvtxOZ.js";class d{constructor(t,o,e,r,i,s,l,c){this.notation=t,this.singleName=o,this.multiName=e,this.propertyName=r,this.order=i,this.ms=s,this.relativeAmount=l,this.visibleByDefault=c}}const S=[new d("s","second","seconds","seconds",3,1e3,1e3,!1),new d("m","minute","minutes","minutes",2,1e3*60,60,!0),new d("h","hour","hours","hours",1,1e3*60*60,60,!1),new d("d","day","days","days",0,1e3*60*60*24,24,!1)];S.forEach((n,t,o)=>n.prev=o[t-1]);S.forEach((n,t,o)=>n.next=o[t+1]);const I=S;function v(n,t){if(!Array.isArray(n))throw new Error("First argument must be an array");return n.filter(e=>e.notation==t)[0]}class N{constructor({defaultNotations:t=!0,notationsEditor:o=null}={defaultNotations:!0,notationsEditor:null}){if(this.notations=[],t===!0)for(const e of I)this.notations.push(Object.assign({},e));typeof o=="function"&&o(this.notations)}}function M(n,t){const o=t<0;o&&(t=t*-1);const e=n.notations.concat().sort((i,s)=>s.ms-i.ms),r={};for(const i of e){const s=Math.floor(t/i.ms);r[i.propertyName]=o?s*-1:s,s>0&&(t-=s*i.ms)}return r}function R(n,t){let o=0;for(const e of n.notations)e.propertyName in t&&(o+=t[e.propertyName]*e.ms);return o}const k=/(?<amount>-?[0-9]+)(?<notation>[a-z])/gi;class C{get notationName(){return this.notation.propertyName}get value(){return M(this.time.setup,this.time.totalMs)[this.notationName]}set value(t){const o=M(this.time.setup,this.time.totalMs)[this.notationName],e=t-o;e!==0&&(this.time.totalMs+=this.notation.ms*e)}constructor(t,o){this.notation=o,this.time=t}}class f{constructor(t,o){if(this.values=[],this.totalMs=0,!(t instanceof N))throw new Error("Setup parameter required");this.setup=t;for(const e of t.notations)this.values.push(new C(this,e));typeof o=="string"?this.totalMs=f.parseTotalMsFromString(t,o):typeof o=="number"?this.totalMs=o:typeof o=="object"&&o instanceof f?this.totalMs=o.totalMs:typeof o=="object"&&o!=null&&(this.totalMs=R(t,o))}static parseTotalMsFromString(t,o){let e=0;for(const r of o.matchAll(k)){if(r.groups==null)throw new Error("missing groups");const i=v(t.notations,r.groups.notation);if(i==null)throw new Error("Did not find a notation for: "+r.groups.notation);e+=i.ms*parseInt(r.groups.amount)}return e}getNotationValue(t){const o=this.values.find(e=>e.notationName==t);if(o!=null)return o.value}add(t){for(const o of t.values){const e=this.values.find(r=>r.notationName==o.notationName);if(e==null)throw new Error("Time has different notation setup");e.value+=o.value}return this}sub(t){for(const o of t.values){const e=this.values.find(r=>r.notationName==o.notationName);if(e==null)throw new Error("Time has different notation setup");e.value-=o.value}return this}clone(){return new f(this.setup,this)}format(){const t=this.values.sort((o,e)=>o.notation.order-e.notation.order);return t.find(o=>o.value)==null?this.formatNotationValue(t.find(o=>o.notation.visibleByDefault===!0)||t[0]):this.formatNotationValues(t.filter(o=>o.value!==0))}formatNotationValues(t){return t.map(o=>this.formatNotationValue(o)).join(" ")}formatNotationValue(t){return t.value+""+t.notation.notation}}f.prototype.toString=function(){return this.format()};const L={name:"add",exec:function(n,t){return n.clone().add(t)}},q={name:"sub",exec:function(n,t){return n.clone().sub(t)}};function T(n){const t=[],o=Array.from(n);let e=0;const r=t,i=function(){o.splice(0,1),e++},s=function(){return o[0]},l=function(a){r.push(a)},c=function(){return r.length!==0&&typeof r[r.length-1]=="string"},$=function(a){c()||r.push(""),r[r.length-1]+=a};for(;o.length>0;){let a=s();if(a=="+")e>0&&l(L);else if(a=="-")e===0&&l("0m"),l(q);else if(a=="("){let h=0,b="";do{if(a==="("&&h++,i(),a=s(),a===")"&&(h--,h===0))break;b+=a}while(a!==")");l(T(b))}else(a.trim()!==""||c())&&$(a);i()}return t}function F(n,t){const o=[];return t.reduce((e,r)=>(typeof r=="string"?e.push(new f(n,r)):Array.isArray(r)?e.push(F(n,r)):e.push(r),e),o)}function z(n,t){const o=Array.isArray(t)?t.map(r=>"("+r+")").join(" + "):t,e=T(o);return F(n,e)}function m(n){if(n===null)return"null";if(n===void 0)return"undefined";if(Array.isArray(n)){let o=`array with ${n.length} item${n.length!==1?"s":""}`;if(n.length>0){const e=n.map(r=>m(r)).join(",");o+=` of the type${e.length!==1?"s":""} [${e}]`}return o}const t=typeof n;switch(t){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return t}return n.constructor.name}function x(n){if(n instanceof f)return n;if(Array.isArray(n))return j(n);throw new Error("Unsupported type: "+m(n))}function G(n){if(n instanceof f)throw new Error("Unsupported type: "+m(n));if(Array.isArray(n))throw new Error("Unsupported type: "+m(n));return n}function j(n){for(;n.length>1;){const[t,o,e]=n.splice(0,3),r=x(t),i=x(e),s=G(o);n.splice(0,0,s.exec(r,i))}return n[0]}function E(n,t){const o=z(n,t);return j(o)}const H=B({data(){return{text:"",dayAmount:"8h",dayParserSetup:new N,currentSetup:null,resultFormat:"s:total"}},computed:{resultFormatOptions(){return[{text:"Total",value:"s:total"}].concat(this.currentSetup?.notations.map(n=>({text:n.multiName,value:n.notation}))??[])},result(){if(this.currentSetup==null)return null;try{return E(this.currentSetup,this.text)}catch{return null}},formattedResult(){if(this.resultFormat=="s:total")return this.result==null?"":this.result.toString();{if(this.currentSetup==null)return"";const n=v(this.currentSetup.notations,this.resultFormat);return this.result==null?"0 "+n.notation:this.result.totalMs/n.ms+" "+n.notation}}},watch:{dayAmount:{handler(n){const t=this.dayParserSetup;this.currentSetup=new N({notationsEditor(o){const e=v(o,"d"),r=E(t,n);console.log(r),e.ms=r.totalMs,e.relativeAmount=r.totalMs/o[o.indexOf(e)-1].ms}})},immediate:!0}}}),J={class:"time-component"},K=["value"],Q={class:"settings"},W=["value"];function X(n,t,o,e,r,i){return y(),p("div",J,[g(u("input",{class:"calc",type:"text","onUpdate:modelValue":t[0]||(t[0]=s=>n.text=s),label:"Time",placeholder:"2h 30m + 1h 45m",style:{width:"100%"}},null,512),[[A,n.text]]),u("div",null,[t[3]||(t[3]=w(" Result: ",-1)),u("input",{class:"result",type:"text",value:n.formattedResult,label:"Result",style:{width:"100%"}},null,8,K)]),u("div",Q,[u("label",null,[t[4]||(t[4]=w(" Result format:Â  ",-1)),g(u("select",{class:"format-selector","onUpdate:modelValue":t[1]||(t[1]=s=>n.resultFormat=s)},[(y(!0),p(U,null,V(n.resultFormatOptions,({text:s,value:l})=>(y(),p("option",{key:l,value:l},D(s),9,W))),128))],512),[[P,n.resultFormat]])]),t[6]||(t[6]=u("br",null,null,-1)),u("label",null,[t[5]||(t[5]=w(" 1 day = ",-1)),g(u("input",{class:"day-field",type:"text","onUpdate:modelValue":t[2]||(t[2]=s=>n.dayAmount=s),outlined:""},null,512),[[A,n.dayAmount]])])])])}const Z=O(H,[["render",X],["__scopeId","data-v-0ce6dd41"]]);export{Z as default};
